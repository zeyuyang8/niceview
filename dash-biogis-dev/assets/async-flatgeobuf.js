/*! For license information please see async-flatgeobuf.js.LICENSE.txt */
"use strict";(self.webpackChunkdash_leaflet=self.webpackChunkdash_leaflet||[]).push([[261],{8351:(t,e,n)=>{n.r(e),n.d(e,{Column:()=>y,Feature:()=>C,Geometry:()=>w,generic:()=>s,geojson:()=>r,ol:()=>i});var s={};n.r(s),n.d(s,{ColumnType:()=>p,GeometryType:()=>_,deserialize:()=>Et,serialize:()=>mt});var i={};n.r(i),n.d(i,{deserialize:()=>On,serialize:()=>An});var r={};n.r(r),n.d(r,{deserialize:()=>Vn,serialize:()=>kn});const o=new Int32Array(2),a=new Float32Array(o.buffer),h=new Float64Array(o.buffer),l=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];var u;!function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"}(u||(u={}));class c{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new c(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return o[0]=this.readInt32(t),a[0]}readFloat64(t){return o[l?0:1]=this.readInt32(t),o[l?1:0]=this.readInt32(t+4),h[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){a[0]=e,this.writeInt32(t,o[0])}writeFloat64(t,e){h[0]=e,this.writeInt32(t,o[l?0:1]),this.writeInt32(t+4,o[l?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=4;const s=this.bytes_.subarray(t,t+n);return e===u.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createScalarList(t,e){const n=[];for(let s=0;s<e;++s){const e=t(s);null!==e&&n.push(e)}return n}createObjList(t,e){const n=[];for(let s=0;s<e;++s){const e=t(s);null!==e&&n.push(e.unpack())}return n}}class d{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,e=t||1024,this.bb=c.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<n+t+e;){const t=this.bb.capacity();this.bb=d.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||e!==n)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,s=c.allocate(n);return s.setPosition(n-e),s.bytes().set(t.bytes(),n-e),s}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const s=2*(n+2);this.addInt16(s);let i=0;const r=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(s==this.bb.readInt16(t)){for(let e=2;e<s;e+=2)if(this.bb.readInt16(r+e)!=this.bb.readInt16(t+e))continue t;i=this.vtables[e];break}}return i?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,i-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const s=n?4:0;if(e){const t=e;if(this.prep(this.minalign,8+s),4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,s=n-this.bb.readInt32(n);if(!(e<this.bb.readInt16(s)&&0!=this.bb.readInt16(s+e)))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(null==t)return 0;let e;e=t instanceof Uint8Array?t:this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let t=0,n=this.space,s=this.bb.bytes();t<e.length;t++)s[n++]=e[t];return this.endVector()}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n];if(null===s)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(s))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}}const f=new Uint8Array(0);function b(t,e){if(!t.length)return e;if(!e.length)return t;var n=new Uint8Array(t.length+e.length);return n.set(t),n.set(e,t.length),n}function g(t){this._source=t,this._array=f,this._index=0}var p,_;g.prototype.read=function(){var t=this,e=t._array.subarray(t._index);return t._source.read().then((function(n){return t._array=f,t._index=0,n.done?e.length>0?{done:!1,value:e}:{done:!0,value:void 0}:{done:!1,value:b(e,n.value)}}))},g.prototype.slice=function(t){if((t|=0)<0)throw new Error("invalid length");var e=this,n=this._array.length-this._index;if(this._index+t<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=t));var s=new Uint8Array(t);return s.set(this._array.subarray(this._index)),function i(){return e._source.read().then((function(r){return r.done?(e._array=f,e._index=0,n>0?s.subarray(0,n):null):n+r.value.length>=t?(e._array=r.value,e._index=t-n,s.set(r.value.subarray(0,t-n),n),s):(s.set(r.value,n),n+=r.value.length,i())}))}()},g.prototype.cancel=function(){return this._source.cancel()},function(t){t[t.Byte=0]="Byte",t[t.UByte=1]="UByte",t[t.Bool=2]="Bool",t[t.Short=3]="Short",t[t.UShort=4]="UShort",t[t.Int=5]="Int",t[t.UInt=6]="UInt",t[t.Long=7]="Long",t[t.ULong=8]="ULong",t[t.Float=9]="Float",t[t.Double=10]="Double",t[t.String=11]="String",t[t.Json=12]="Json",t[t.DateTime=13]="DateTime",t[t.Binary=14]="Binary"}(p||(p={}));class y{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsColumn(t,e){return(e||new y).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsColumn(t,e){return t.setPosition(t.position()+4),(e||new y).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}type(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):p.Byte}title(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}width(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt32(this.bb_pos+t):-1}precision(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt32(this.bb_pos+t):-1}scale(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):-1}nullable(){const t=this.bb.__offset(this.bb_pos,18);return!t||!!this.bb.readInt8(this.bb_pos+t)}unique(){const t=this.bb.__offset(this.bb_pos,20);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}primaryKey(){const t=this.bb.__offset(this.bb_pos,22);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}metadata(t){const e=this.bb.__offset(this.bb_pos,24);return e?this.bb.__string(this.bb_pos+e,t):null}static startColumn(t){t.startObject(11)}static addName(t,e){t.addFieldOffset(0,e,0)}static addType(t,e){t.addFieldInt8(1,e,p.Byte)}static addTitle(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWidth(t,e){t.addFieldInt32(4,e,-1)}static addPrecision(t,e){t.addFieldInt32(5,e,-1)}static addScale(t,e){t.addFieldInt32(6,e,-1)}static addNullable(t,e){t.addFieldInt8(7,+e,1)}static addUnique(t,e){t.addFieldInt8(8,+e,0)}static addPrimaryKey(t,e){t.addFieldInt8(9,+e,0)}static addMetadata(t,e){t.addFieldOffset(10,e,0)}static endColumn(t){const e=t.endObject();return t.requiredField(e,4),e}static createColumn(t,e,n,s,i,r,o,a,h,l,u,c){return y.startColumn(t),y.addName(t,e),y.addType(t,n),y.addTitle(t,s),y.addDescription(t,i),y.addWidth(t,r),y.addPrecision(t,o),y.addScale(t,a),y.addNullable(t,h),y.addUnique(t,l),y.addPrimaryKey(t,u),y.addMetadata(t,c),y.endColumn(t)}}class m{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsCrs(t,e){return(e||new m).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsCrs(t,e){return t.setPosition(t.position()+4),(e||new m).__init(t.readInt32(t.position())+t.position(),t)}org(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}code(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}name(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__string(this.bb_pos+e,t):null}wkt(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__string(this.bb_pos+e,t):null}codeString(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__string(this.bb_pos+e,t):null}static startCrs(t){t.startObject(6)}static addOrg(t,e){t.addFieldOffset(0,e,0)}static addCode(t,e){t.addFieldInt32(1,e,0)}static addName(t,e){t.addFieldOffset(2,e,0)}static addDescription(t,e){t.addFieldOffset(3,e,0)}static addWkt(t,e){t.addFieldOffset(4,e,0)}static addCodeString(t,e){t.addFieldOffset(5,e,0)}static endCrs(t){return t.endObject()}static createCrs(t,e,n,s,i,r,o){return m.startCrs(t),m.addOrg(t,e),m.addCode(t,n),m.addName(t,s),m.addDescription(t,i),m.addWkt(t,r),m.addCodeString(t,o),m.endCrs(t)}}!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon",t[t.MultiPoint=4]="MultiPoint",t[t.MultiLineString=5]="MultiLineString",t[t.MultiPolygon=6]="MultiPolygon",t[t.GeometryCollection=7]="GeometryCollection",t[t.CircularString=8]="CircularString",t[t.CompoundCurve=9]="CompoundCurve",t[t.CurvePolygon=10]="CurvePolygon",t[t.MultiCurve=11]="MultiCurve",t[t.MultiSurface=12]="MultiSurface",t[t.Curve=13]="Curve",t[t.Surface=14]="Surface",t[t.PolyhedralSurface=15]="PolyhedralSurface",t[t.TIN=16]="TIN",t[t.Triangle=17]="Triangle"}(_||(_={}));class v{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsHeader(t,e){return(e||new v).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsHeader(t,e){return t.setPosition(t.position()+4),(e||new v).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}envelope(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}envelopeLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}envelopeArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}geometryType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):_.Unknown}hasZ(){const t=this.bb.__offset(this.bb_pos,10);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasM(){const t=this.bb.__offset(this.bb_pos,12);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasT(){const t=this.bb.__offset(this.bb_pos,14);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}hasTm(){const t=this.bb.__offset(this.bb_pos,16);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}columns(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new y).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}featuresCount(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readUint64(this.bb_pos+t):BigInt("0")}indexNodeSize(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readUint16(this.bb_pos+t):16}crs(t){const e=this.bb.__offset(this.bb_pos,24);return e?(t||new m).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}title(t){const e=this.bb.__offset(this.bb_pos,26);return e?this.bb.__string(this.bb_pos+e,t):null}description(t){const e=this.bb.__offset(this.bb_pos,28);return e?this.bb.__string(this.bb_pos+e,t):null}metadata(t){const e=this.bb.__offset(this.bb_pos,30);return e?this.bb.__string(this.bb_pos+e,t):null}static startHeader(t){t.startObject(14)}static addName(t,e){t.addFieldOffset(0,e,0)}static addEnvelope(t,e){t.addFieldOffset(1,e,0)}static createEnvelopeVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startEnvelopeVector(t,e){t.startVector(8,e,8)}static addGeometryType(t,e){t.addFieldInt8(2,e,_.Unknown)}static addHasZ(t,e){t.addFieldInt8(3,+e,0)}static addHasM(t,e){t.addFieldInt8(4,+e,0)}static addHasT(t,e){t.addFieldInt8(5,+e,0)}static addHasTm(t,e){t.addFieldInt8(6,+e,0)}static addColumns(t,e){t.addFieldOffset(7,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static addFeaturesCount(t,e){t.addFieldInt64(8,e,BigInt("0"))}static addIndexNodeSize(t,e){t.addFieldInt16(9,e,16)}static addCrs(t,e){t.addFieldOffset(10,e,0)}static addTitle(t,e){t.addFieldOffset(11,e,0)}static addDescription(t,e){t.addFieldOffset(12,e,0)}static addMetadata(t,e){t.addFieldOffset(13,e,0)}static endHeader(t){return t.endObject()}static finishHeaderBuffer(t,e){t.finish(e)}static finishSizePrefixedHeaderBuffer(t,e){t.finish(e,void 0,!0)}}class w{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsGeometry(t,e){return(e||new w).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsGeometry(t,e){return t.setPosition(t.position()+4),(e||new w).__init(t.readInt32(t.position())+t.position(),t)}ends(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readUint32(this.bb.__vector(this.bb_pos+e)+4*t):0}endsLength(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__vector_len(this.bb_pos+t):0}endsArray(){const t=this.bb.__offset(this.bb_pos,4);return t?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}xy(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}xyLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}xyArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}z(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}zLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}zArray(){const t=this.bb.__offset(this.bb_pos,8);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}m(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}mLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}mArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}t(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readFloat64(this.bb.__vector(this.bb_pos+e)+8*t):0}tLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}tArray(){const t=this.bb.__offset(this.bb_pos,12);return t?new Float64Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}tm(t){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.readUint64(this.bb.__vector(this.bb_pos+e)+8*t):BigInt(0)}tmLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}type(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):_.Unknown}parts(t,e){const n=this.bb.__offset(this.bb_pos,18);return n?(e||new w).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}partsLength(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.__vector_len(this.bb_pos+t):0}static startGeometry(t){t.startObject(8)}static addEnds(t,e){t.addFieldOffset(0,e,0)}static createEndsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startEndsVector(t,e){t.startVector(4,e,4)}static addXy(t,e){t.addFieldOffset(1,e,0)}static createXyVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startXyVector(t,e){t.startVector(8,e,8)}static addZ(t,e){t.addFieldOffset(2,e,0)}static createZVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startZVector(t,e){t.startVector(8,e,8)}static addM(t,e){t.addFieldOffset(3,e,0)}static createMVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startMVector(t,e){t.startVector(8,e,8)}static addT(t,e){t.addFieldOffset(4,e,0)}static createTVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addFloat64(e[n]);return t.endVector()}static startTVector(t,e){t.startVector(8,e,8)}static addTm(t,e){t.addFieldOffset(5,e,0)}static createTmVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startTmVector(t,e){t.startVector(8,e,8)}static addType(t,e){t.addFieldInt8(6,e,_.Unknown)}static addParts(t,e){t.addFieldOffset(7,e,0)}static createPartsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startPartsVector(t,e){t.startVector(4,e,4)}static endGeometry(t){return t.endObject()}static createGeometry(t,e,n,s,i,r,o,a,h){return w.startGeometry(t),w.addEnds(t,e),w.addXy(t,n),w.addZ(t,s),w.addM(t,i),w.addT(t,r),w.addTm(t,o),w.addType(t,a),w.addParts(t,h),w.endGeometry(t)}}class C{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFeature(t,e){return(e||new C).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFeature(t,e){return t.setPosition(t.position()+4),(e||new C).__init(t.readInt32(t.position())+t.position(),t)}geometry(t){const e=this.bb.__offset(this.bb_pos,4);return e?(t||new w).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}properties(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb.__vector(this.bb_pos+e)+t):0}propertiesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}propertiesArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}columns(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new y).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}columnsLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFeature(t){t.startObject(3)}static addGeometry(t,e){t.addFieldOffset(0,e,0)}static addProperties(t,e){t.addFieldOffset(1,e,0)}static createPropertiesVector(t,e){t.startVector(1,e.length,1);for(let n=e.length-1;n>=0;n--)t.addInt8(e[n]);return t.endVector()}static startPropertiesVector(t,e){t.startVector(1,e,1)}static addColumns(t,e){t.addFieldOffset(2,e,0)}static createColumnsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startColumnsVector(t,e){t.startVector(4,e,4)}static endFeature(t){return t.endObject()}static finishFeatureBuffer(t,e){t.finish(e)}static finishSizePrefixedFeatureBuffer(t,e){t.finish(e,void 0,!0)}static createFeature(t,e,n,s){return C.startFeature(t),C.addGeometry(t,e),C.addProperties(t,n),C.addColumns(t,s),C.endFeature(t)}}function x(t){const e=v.getRootAsHeader(t),n=e.featuresCount(),s=e.indexNodeSize(),i=[];for(let t=0;t<e.columnsLength();t++){const n=e.columns(t);if(!n)throw new Error("Column unexpectedly missing");if(!n.name())throw new Error("Column name unexpectedly missing");i.push({name:n.name(),type:n.type(),title:n.title(),description:n.description(),width:n.width(),precision:n.precision(),scale:n.scale(),nullable:n.nullable(),unique:n.unique(),primary_key:n.primaryKey()})}const r=e.crs(),o=r?{org:r.org(),code:r.code(),name:r.name(),description:r.description(),wkt:r.wkt(),code_string:r.codeString()}:null;return{geometryType:e.geometryType(),columns:i,envelope:null,featuresCount:Number(n),indexNodeSize:s,crs:o,title:e.title(),description:e.description(),metadata:e.metadata()}}function I(t,e){const{xy:n,z:s,ends:i,parts:r,type:o}=e;if(r){const e=r.map((e=>I(t,e))),n=w.createPartsVector(t,e);return w.startGeometry(t),w.addParts(t,n),w.addType(t,o),w.endGeometry(t)}const a=w.createXyVector(t,n);let h,l;return s&&(h=w.createZVector(t,s)),i&&(l=w.createEndsVector(t,i)),w.startGeometry(t),l&&w.addEnds(t,l),w.addXy(t,a),h&&w.addZ(t,h),w.addType(t,o),w.endGeometry(t)}function F(t,e,n){if(0!==t.length)if(Array.isArray(t[0]))for(const s of t)F(s,e,n);else 2===t.length?e.push(...t):(e.push(t[0],t[1]),n.push(t[2]))}function P(t,e){let n,s,i,r=e;if(r===_.Unknown&&(r=S(t.getType())),r===_.MultiLineString){t.getFlatCoordinates&&(n=t.getFlatCoordinates());const e=t.getEnds();e.length>1&&(s=e.map((t=>t>>1)))}else if(r===_.Polygon){t.getFlatCoordinates&&(n=t.getFlatCoordinates());const e=t.getEnds();e.length>1&&(s=e.map((t=>t>>1)))}else r===_.MultiPolygon?i=t.getPolygons().map((t=>P(t,_.Polygon))):t.getFlatCoordinates&&(n=t.getFlatCoordinates());return{xy:n,ends:s,type:r,parts:i}}function E(t,e){const n=[];for(let s=0;s<t.length;s+=2){const i=[t[s],t[s+1]];e&&i.push(e[s>>1]),n.push(i)}return n}function S(t){return t?_[t]:_.Unknown}const R=new TextEncoder,U=new TextDecoder;function T(t,e,n){const s=n.columns,i=new d;let r=0,o=1024,a=new Uint8Array(o),h=new DataView(a.buffer);const l=function(t){if(r+t<o)return;o=Math.max(o+t,2*o);const e=new Uint8Array(o);e.set(a),a=e,h=new DataView(a.buffer)};if(s)for(let t=0;t<s.length;t++){const n=s[t],i=e[n.name];if(null!==i)switch(l(2),h.setUint16(r,t,!0),r+=2,n.type){case p.Bool:l(1),h.setUint8(r,i),r+=1;break;case p.Short:l(2),h.setInt16(r,i,!0),r+=2;break;case p.UShort:l(2),h.setUint16(r,i,!0),r+=2;break;case p.Int:l(4),h.setInt32(r,i,!0),r+=4;break;case p.UInt:l(4),h.setUint32(r,i,!0),r+=4;break;case p.Long:l(8),h.setBigInt64(r,BigInt(i),!0),r+=8;break;case p.Float:l(4),h.setFloat32(r,i,!0),r+=4;break;case p.Double:l(8),h.setFloat64(r,i,!0),r+=8;break;case p.DateTime:case p.String:{const t=R.encode(i);l(4),h.setUint32(r,t.length,!0),r+=4,l(t.length),a.set(t,r),r+=t.length;break}case p.Json:{const t=R.encode(JSON.stringify(i));l(4),h.setUint32(r,t.length,!0),r+=4,l(t.length),a.set(t,r),r+=t.length;break}default:throw new Error("Unknown type "+n.type)}}let u=null;r>0&&(u=C.createPropertiesVector(i,a.slice(0,r)));const c=I(i,t);C.startFeature(i),C.addGeometry(i,c),u&&C.addProperties(i,u);const f=C.endFeature(i);return i.finishSizePrefixed(f),i.asUint8Array()}function A(t,e){const n={};if(!e||0===e.length)return n;const s=t.propertiesArray();if(!s)return n;const i=new DataView(s.buffer,s.byteOffset),r=t.propertiesLength();let o=0;for(;o<r;){const t=i.getUint16(o,!0);o+=2;const r=e[t],a=r.name;switch(r.type){case p.Bool:n[a]=!!i.getUint8(o),o+=1;break;case p.Byte:n[a]=i.getInt8(o),o+=1;break;case p.UByte:n[a]=i.getUint8(o),o+=1;break;case p.Short:n[a]=i.getInt16(o,!0),o+=2;break;case p.UShort:n[a]=i.getUint16(o,!0),o+=2;break;case p.Int:n[a]=i.getInt32(o,!0),o+=4;break;case p.UInt:n[a]=i.getUint32(o,!0),o+=4;break;case p.Long:n[a]=Number(i.getBigInt64(o,!0)),o+=8;break;case p.ULong:n[a]=Number(i.getBigUint64(o,!0)),o+=8;break;case p.Float:n[a]=i.getFloat32(o,!0),o+=4;break;case p.Double:n[a]=i.getFloat64(o,!0),o+=8;break;case p.DateTime:case p.String:{const t=i.getUint32(o,!0);o+=4,n[a]=U.decode(s.subarray(o,o+t)),o+=t;break}case p.Json:{const t=i.getUint32(o,!0);o+=4;const e=U.decode(s.subarray(o,o+t));n[a]=JSON.parse(e),o+=t;break}default:throw new Error("Unknown type "+r.type)}}return n}var O=function(t,e){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},O(t,e)};function N(t,e,n,s){return new(n||(n=Promise))((function(i,r){function o(t){try{h(s.next(t))}catch(t){r(t)}}function a(t){try{h(s.throw(t))}catch(t){r(t)}}function h(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}h((s=s.apply(t,e||[])).next())}))}function M(t,e){var n,s,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,s&&(i=2&r[0]?s.return:r[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,r[1])).done)return i;switch(s=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,s=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],s=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function L(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function G(t){return this instanceof G?(this.v=t,this):new G(t)}var B=function(t){function e(e){var n=t.call(this,e)||this;return Object.defineProperty(n,"name",{value:"RepeaterOverflowError",enumerable:!1}),"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf(n,n.constructor.prototype):n.__proto__=n.constructor.prototype,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(n,n.constructor),n}return function(t,e){function n(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error);function k(t){null!=t&&"function"==typeof t.then&&t.then(j,j)}(function(){function t(t){if(t<0)throw new RangeError("Capacity may not be less than 0");this._c=t,this._q=[]}Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this._q.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"full",{get:function(){return this._q.length>=this._c},enumerable:!1,configurable:!0}),t.prototype.add=function(t){if(this.full)throw new Error("Buffer full");this._q.push(t)},t.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()}})(),function(){function t(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this._q.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.add=function(t){for(;this._q.length>=this._c;)this._q.shift();this._q.push(t)},t.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()}}(),function(){function t(t){if(t<1)throw new RangeError("Capacity may not be less than 1");this._c=t,this._q=[]}Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this._q.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"full",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._q.length<this._c&&this._q.push(t)},t.prototype.remove=function(){if(this.empty)throw new Error("Buffer empty");return this._q.shift()}}();var V=2,q=3,D=4,X=1024,j=function(){};function z(t){var e=t.err,n=Promise.resolve(t.execution).then((function(t){if(null!=e)throw e;return t}));return t.err=void 0,t.execution=n.then((function(){}),(function(){})),void 0===t.pending?n:t.pending.then((function(){return n}))}function Y(t,e){var n=t.state>=q;return Promise.resolve(e).then((function(e){return!n&&t.state>=D?z(t).then((function(t){return{value:t,done:!0}})):{value:e,done:n}}))}function $(t,e){var n,s;if(!(t.state>=V))if(t.state=V,t.onnext(),t.onstop(),null==t.err&&(t.err=e),0!==t.pushes.length||void 0!==t.buffer&&!t.buffer.empty)try{for(var i=L(t.pushes),r=i.next();!r.done;r=i.next())r.value.resolve()}catch(t){n={error:t}}finally{try{r&&!r.done&&(s=i.return)&&s.call(i)}finally{if(n)throw n.error}}else W(t)}function W(t){var e,n;if(!(t.state>=q)){t.state<V&&$(t),t.state=q,t.buffer=void 0;try{for(var s=L(t.nexts),i=s.next();!i.done;i=s.next()){var r=i.value,o=void 0===t.pending?z(t):t.pending.then((function(){return z(t)}));r.resolve(Y(t,o))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}t.pushes=[],t.nexts=[]}}function H(t){t.state>=D||(t.state<q&&W(t),t.state=D)}function Z(t,e){if(k(e),t.pushes.length>=X)throw new B("No more than "+X+" pending calls to push are allowed on a single repeater.");if(t.state>=V)return Promise.resolve(void 0);var n,s=void 0===t.pending?Promise.resolve(e):t.pending.then((function(){return e}));s=s.catch((function(e){t.state<V&&(t.err=e),H(t)})),t.nexts.length?(t.nexts.shift().resolve(Y(t,s)),n=t.nexts.length?Promise.resolve(t.nexts[0].value):new Promise((function(e){return t.onnext=e}))):void 0===t.buffer||t.buffer.full?n=new Promise((function(e){return t.pushes.push({resolve:e,value:s})})):(t.buffer.add(s),n=Promise.resolve(void 0));var i=!0,r={},o=n.catch((function(t){if(i)throw t}));return r.then=function(t,e){return i=!1,Promise.prototype.then.call(n,t,e)},r.catch=function(t){return i=!1,Promise.prototype.catch.call(n,t)},r.finally=n.finally.bind(n),t.pending=s.then((function(){return o})).catch((function(e){t.err=e,H(t)})),r}function K(t){if(!(t.state>=1)){t.state=1;var e=Z.bind(null,t),n=function(t){var e=$.bind(null,t),n=new Promise((function(e){return t.onstop=e}));return e.then=n.then.bind(n),e.catch=n.catch.bind(n),e.finally=n.finally.bind(n),e}(t);t.execution=new Promise((function(s){return s(t.executor(e,n))})),t.execution.catch((function(){return $(t)}))}}var J=new WeakMap,Q=function(){function t(t,e){J.set(this,{executor:t,buffer:e,err:void 0,state:0,pushes:[],nexts:[],pending:void 0,execution:void 0,onnext:j,onstop:j})}return t.prototype.next=function(t){k(t);var e=J.get(this);if(void 0===e)throw new Error("WeakMap error");if(e.nexts.length>=X)throw new B("No more than "+X+" pending calls to next are allowed on a single repeater.");if(e.state<=0&&K(e),e.onnext(t),void 0!==e.buffer&&!e.buffer.empty){var n=Y(e,e.buffer.remove());if(e.pushes.length){var s=e.pushes.shift();e.buffer.add(s.value),e.onnext=s.resolve}return n}if(e.pushes.length){var i=e.pushes.shift();return e.onnext=i.resolve,Y(e,i.value)}return e.state>=V?(W(e),Y(e,z(e))):new Promise((function(n){return e.nexts.push({resolve:n,value:t})}))},t.prototype.return=function(t){k(t);var e=J.get(this);if(void 0===e)throw new Error("WeakMap error");return W(e),e.execution=Promise.resolve(e.execution).then((function(){return t})),Y(e,z(e))},t.prototype.throw=function(t){var e=J.get(this);if(void 0===e)throw new Error("WeakMap error");return e.state<=0||e.state>=V||void 0!==e.buffer&&!e.buffer.empty?(W(e),null==e.err&&(e.err=t),Y(e,z(e))):this.next(Promise.reject(t))},t.prototype[Symbol.asyncIterator]=function(){return this},t.race=et,t.merge=nt,t.zip=st,t.latest=it,t}();function tt(t,e){var n,s,i=[],r=function(t){null!=t&&"function"==typeof t[Symbol.asyncIterator]?i.push(t[Symbol.asyncIterator]()):null!=t&&"function"==typeof t[Symbol.iterator]?i.push(t[Symbol.iterator]()):i.push(function(){return function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=n.apply(t,e||[]),r=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(t){i[t]&&(s[t]=function(e){return new Promise((function(n,s){r.push([t,e,n,s])>1||a(t,e)}))})}function a(t,e){try{(n=i[t](e)).value instanceof G?Promise.resolve(n.value.v).then(h,l):u(r[0][2],n)}catch(t){u(r[0][3],t)}var n}function h(t){a("next",t)}function l(t){a("throw",t)}function u(t,e){t(e),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function(){return M(this,(function(n){switch(n.label){case 0:return e.yieldValues?[4,G(t)]:[3,3];case 1:return[4,n.sent()];case 2:n.sent(),n.label=3;case 3:return e.returnValues?[4,G(t)]:[3,5];case 4:return[2,n.sent()];case 5:return[2]}}))}))}())};try{for(var o=L(t),a=o.next();!a.done;a=o.next())r(a.value)}catch(t){n={error:t}}finally{try{a&&!a.done&&(s=o.return)&&s.call(o)}finally{if(n)throw n.error}}return i}function et(t){var e=this,n=tt(t,{returnValues:!0});return new Q((function(t,s){return N(e,void 0,void 0,(function(){var e,i,r,o,a,h;return M(this,(function(l){switch(l.label){case 0:if(!n.length)return s(),[2];i=!1,s.then((function(){e(),i=!0})),l.label=1;case 1:l.trys.push([1,,5,7]),o=void 0,a=0,h=function(){var i,h,l,u,c,d;return M(this,(function(f){switch(f.label){case 0:i=a;try{for(c=void 0,h=L(n),l=h.next();!l.done;l=h.next())u=l.value,Promise.resolve(u.next()).then((function(t){t.done?(s(),void 0===r&&(r=t)):a===i&&(a++,e(t))}),(function(t){return s(t)}))}catch(t){c={error:t}}finally{try{l&&!l.done&&(d=h.return)&&d.call(h)}finally{if(c)throw c.error}}return[4,new Promise((function(t){return e=t}))];case 1:return void 0===(o=f.sent())?[3,3]:[4,t(o.value)];case 2:f.sent(),f.label=3;case 3:return[2]}}))},l.label=2;case 2:return i?[3,4]:[5,h()];case 3:return l.sent(),[3,2];case 4:return[2,r&&r.value];case 5:return s(),[4,Promise.race(n.map((function(t){return t.return&&t.return()})))];case 6:return l.sent(),[7];case 7:return[2]}}))}))}))}function nt(t){var e=this,n=tt(t,{yieldValues:!0});return new Q((function(t,s){return N(e,void 0,void 0,(function(){var e,i,r,o=this;return M(this,(function(a){switch(a.label){case 0:if(!n.length)return s(),[2];e=[],i=!1,s.then((function(){var t,n;i=!0;try{for(var s=L(e),r=s.next();!r.done;r=s.next())(0,r.value)()}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}})),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,Promise.all(n.map((function(n,a){return N(o,void 0,void 0,(function(){var o;return M(this,(function(h){switch(h.label){case 0:h.trys.push([0,,6,9]),h.label=1;case 1:return i?[3,5]:(Promise.resolve(n.next()).then((function(t){return e[a](t)}),(function(t){return s(t)})),[4,new Promise((function(t){e[a]=t}))]);case 2:return void 0===(o=h.sent())?[3,4]:o.done?(r=o,[2]):[4,t(o.value)];case 3:h.sent(),h.label=4;case 4:return[3,1];case 5:return[3,9];case 6:return n.return?[4,n.return()]:[3,8];case 7:h.sent(),h.label=8;case 8:return[7];case 9:return[2]}}))}))})))];case 2:return a.sent(),[2,r&&r.value];case 3:return s(),[7];case 4:return[2]}}))}))}))}function st(t){var e=this,n=tt(t,{returnValues:!0});return new Q((function(t,s){return N(e,void 0,void 0,(function(){var e,i,r,o;return M(this,(function(a){switch(a.label){case 0:if(!n.length)return s(),[2,[]];i=!1,s.then((function(){e(),i=!0})),a.label=1;case 1:a.trys.push([1,,6,8]),a.label=2;case 2:return i?[3,5]:(Promise.all(n.map((function(t){return t.next()}))).then((function(t){return e(t)}),(function(t){return s(t)})),[4,new Promise((function(t){return e=t}))]);case 3:return void 0===(r=a.sent())?[2]:(o=r.map((function(t){return t.value})),r.some((function(t){return t.done}))?[2,o]:[4,t(o)]);case 4:return a.sent(),[3,2];case 5:return[3,8];case 6:return s(),[4,Promise.all(n.map((function(t){return t.return&&t.return()})))];case 7:return a.sent(),[7];case 8:return[2]}}))}))}))}function it(t){var e=this,n=tt(t,{yieldValues:!0,returnValues:!0});return new Q((function(t,s){return N(e,void 0,void 0,(function(){var e,i,r,o,a,h=this;return M(this,(function(l){switch(l.label){case 0:if(!n.length)return s(),[2,[]];i=[],r=!1,s.then((function(){var t,n;e();try{for(var s=L(i),o=s.next();!o.done;o=s.next())(0,o.value)()}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}r=!0})),l.label=1;case 1:return l.trys.push([1,,5,7]),Promise.all(n.map((function(t){return t.next()}))).then((function(t){return e(t)}),(function(t){return s(t)})),[4,new Promise((function(t){return e=t}))];case 2:return void 0===(o=l.sent())?[2]:(a=o.map((function(t){return t.value})),o.every((function(t){return t.done}))?[2,a]:[4,t(a.slice())]);case 3:return l.sent(),[4,Promise.all(n.map((function(e,n){return N(h,void 0,void 0,(function(){var h;return M(this,(function(l){switch(l.label){case 0:if(o[n].done)return[2,o[n].value];l.label=1;case 1:return r?[3,4]:(Promise.resolve(e.next()).then((function(t){return i[n](t)}),(function(t){return s(t)})),[4,new Promise((function(t){return i[n]=t}))]);case 2:return void 0===(h=l.sent())?[2,o[n].value]:h.done?[2,h.value]:(a[n]=h.value,[4,t(a.slice())]);case 3:return l.sent(),[3,1];case 4:return[2]}}))}))})))];case 4:return[2,l.sent()];case 5:return s(),[4,Promise.all(n.map((function(t){return t.return&&t.return()})))];case 6:return l.sent(),[7];case 7:return[2]}}))}))}))}class rt{constructor(){this._extraRequestThreshold=262144}extraRequestThreshold(){return this._extraRequestThreshold}setExtraRequestThreshold(t){if(t<0)throw new Error("extraRequestThreshold cannot be negative");this._extraRequestThreshold=t}}rt.global=new rt;const ot=rt;var at;!function(t){t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warn=2]="Warn",t[t.Error=3]="Error"}(at||(at={}));class ht{static debug(...t){this.log(at.Debug,...t)}static info(...t){this.log(at.Info,...t)}static warn(...t){this.log(at.Warn,...t)}static error(...t){this.log(at.Error,...t)}static log(t,...e){if(!(this.logLevel>t))switch(t){case at.Debug:console.debug(...e);break;case at.Info:console.info(...e);break;case at.Warn:console.warn(...e);break;case at.Error:console.error(...e)}}}ht.logLevel=at.Warn;const lt=ht,ut=40;function ct(t,e){e=Math.min(Math.max(+e,2),65535);let n=t,s=n;do{n=Math.ceil(n/e),s+=n}while(1!==n);return s*ut}function dt(t,e){if(0!=(4293918720&t))throw Error("integer is too large to be safely represented");return e+t*2**32}const ft=new Uint8Array([102,103,98,3,102,103,98,0]),bt=4;class gt{constructor(t,e,n,s){this.headerClient=t,this.header=e,this.headerLength=n,this.indexLength=s}static async open(t){const e=new pt(t),n=(()=>{let t,e=0;for(t=0;t<3;t++)e+=16**t*ut;return e})(),s=2024+n;lt.debug(`fetching header. minReqLength: ${s} (assumedHeaderLength: 2024, assumedIndexLength: ${n})`);{const t=new Uint8Array(await e.getRange(0,8,s,"header"));if(!t.subarray(0,3).every(((t,e)=>ft[e]===t)))throw lt.error(`bytes: ${t} != ${ft}`),new Error("Not a FlatGeobuf file");lt.debug("magic bytes look good")}let i;{const t=await e.getRange(8,4,s,"header");if(i=new DataView(t).getUint32(0,!0),i>10485760||i<8)throw new Error("Invalid header size");lt.debug(`headerLength: ${i}`)}const r=await e.getRange(12,i,s,"header"),o=x(new c(new Uint8Array(r))),a=ct(o.featuresCount,o.indexNodeSize);return lt.debug("completed: opening http reader"),new gt(e,o,i,a)}async*selectBbox(t){const e=this.lengthBeforeTree(),n=this.headerClient,s=async function(t,s){return n.getRange(e+t,s,0,"index")},i=[];let r=[];for await(const e of async function*(t,e,n,s){class i{constructor(t,e){this._level=e,this.nodes=t}level(){return this._level}startNode(){return this.nodes[0]}endNode(){return this.nodes[1]}extendEndNodeToNewOffset(t){console.assert(t>this.nodes[1]),this.nodes[1]=t}toString(){return`[NodeRange level: ${this._level}, nodes: ${this.nodes[0]}-${this.nodes[1]}]`}}const{minX:r,minY:o,maxX:a,maxY:h}=n;lt.info(`tree items: ${t}, nodeSize: ${e}`);const l=function(t,e){if(e<2)throw new Error("Node size must be at least 2");if(0===t)throw new Error("Number of items must be greater than 0");let n=t,s=n;const i=[n];do{n=Math.ceil(n/e),s+=n,i.push(n)}while(1!==n);const r=[];n=s;for(const t of i)r.push(n-t),n-=t;const o=[];for(let t=0;t<i.length;t++)o.push([r[t],r[t]+i[t]]);return o}(t,e),u=l[0][0],c=[(()=>{const t=l.length-1;return new i([0,1],t)})()];for(lt.debug(`starting stream search with queue: ${c}, numItems: ${t}, nodeSize: ${e}, levelBounds: ${l}`);0!=c.length;){const n=c.shift();lt.debug(`popped node: ${n}, queueLength: ${c.length}`);const d=n.startNode(),f=d>=u,[,b]=l[n.level()],g=Math.min(n.endNode()+e,b),p=g-d,_=await s(d*ut,p*ut),y=new Float64Array(_),m=new Uint32Array(_);for(let e=d;e<g;e++){const s=5*(e-d);if(a<y[s+0])continue;if(h<y[s+1])continue;if(r>y[s+2])continue;if(o>y[s+3])continue;const l=m[8+(s<<1)],b=dt(m[9+(s<<1)],l);if(f){const n=(()=>{if(e<t-1){const t=5*(e-d+1),n=m[8+(t<<1)];return dt(m[9+(t<<1)],n)-b}return null})();yield[b,e-u,n];continue}const g=ot.global.extraRequestThreshold()/ut,p=c[c.length-1];if(void 0!==p&&p.level()==n.level()-1&&b<p.endNode()+g){lt.debug(`Merging "nodeRange" request into existing range: ${p}, newOffset: ${p.endNode()} -> ${b}`),p.extendEndNodeToNewOffset(b);continue}const _=(()=>{const t=n.level()-1;return new i([b,b+1],t)})();void 0!==p&&p.level()==_.level()?lt.info(`Same level, but too far away. Pushing new request at offset: ${b} rather than merging with distant ${p}`):lt.info(`Pushing new level for ${_} onto queue with nearestNodeRange: ${p} since there's not already a range for this level.`),c.push(_)}}}(this.header.featuresCount,this.header.indexNodeSize,t,s)){const[t,,]=e;let[,,n]=e;if(n||(lt.info("final feature"),n=ot.global.extraRequestThreshold()),0==r.length){r.push([t,n]);continue}const s=r[r.length-1],o=t-(s[0]+s[1]);o>ot.global.extraRequestThreshold()&&(lt.info(`Pushing new feature batch, since gap ${o} was too large`),i.push(r),r=[]),r.push([t,n])}this.headerClient.logUsage("header+index"),r.length>0&&i.push(r);const o=i.flatMap((t=>this.readFeatureBatch(t)));yield*Q.merge(o)}lengthBeforeTree(){return ft.length+bt+this.headerLength}lengthBeforeFeatures(){return this.lengthBeforeTree()+this.indexLength}buildFeatureClient(){return new pt(this.headerClient.httpClient)}async*readFeatureBatch(t){const[e]=t[0],[n,s]=t[t.length-1],i=n+s-e,r=this.buildFeatureClient();for(const[e]of t)yield await this.readFeature(r,e,i);r.logUsage("feature")}async readFeature(t,e,n){const s=e+this.lengthBeforeFeatures();let i;{const e=await t.getRange(s,4,n,"feature length");i=new DataView(e).getUint32(0,!0)}const r=await t.getRange(s+4,i,n,"feature data"),o=new Uint8Array(r),a=new Uint8Array(i+bt);a.set(o,bt);const h=new c(a);return h.setPosition(bt),C.getRootAsFeature(h)}}class pt{constructor(t){this.bytesEverUsed=0,this.bytesEverFetched=0,this.buffer=new ArrayBuffer(0),this.head=0,this.httpClient="string"==typeof t?new _t(t):t}async getRange(t,e,n,s){this.bytesEverUsed+=e;const i=t-this.head,r=i+e;if(i>=0&&r<=this.buffer.byteLength)return this.buffer.slice(i,r);const o=Math.max(e,n);return this.bytesEverFetched+=o,lt.debug(`requesting for new Range: ${t}-${t+e-1}`),this.buffer=await this.httpClient.getRange(t,o,s),this.head=t,this.buffer.slice(0,e)}logUsage(t){const e=t.split(" ")[0],n=this.bytesEverUsed,s=this.bytesEverFetched,i=(100*n/s).toFixed(2);lt.info(`${e} bytes used/requested: ${n} / ${s} = ${i}%`)}}class _t{constructor(t){this.requestsEverMade=0,this.bytesEverRequested=0,this.url=t}async getRange(t,e,n){this.requestsEverMade+=1,this.bytesEverRequested+=e;const s=`bytes=${t}-${t+e-1}`;return lt.info(`request: #${this.requestsEverMade}, purpose: ${n}), bytes: (this_request: ${e}, ever: ${this.bytesEverRequested}), Range: ${s}`),(await fetch(this.url,{headers:{Range:s}})).arrayBuffer()}}function yt(t){let e;for(const s of t){if(e===_.Unknown)break;const t=(n=s).getGeometry?S(n.getGeometry().getType()):S(n.geometry.type);void 0===e?e=t:e!==t&&(e=_.Unknown)}var n;if(void 0===e)throw new Error("Could not infer geometry type for collection of features.");return e}function mt(t){const e=function(t){const e=t[0],n=e.getProperties?e.getProperties():{};let s=null;n&&(s=Object.keys(n).filter((t=>"geometry"!==t)).map((t=>Pt(n,t))));return{geometryType:yt(t),columns:s,envelope:null,featuresCount:t.length,indexNodeSize:0,crs:null,title:null,description:null,metadata:null}}(t),n=It(e),s=t.map((t=>{if(!t.getGeometry)throw new Error("Missing getGeometry implementation");if(!t.getProperties)throw new Error("Missing getProperties implementation");return T(P(t.getGeometry(),e.geometryType),t.getProperties(),e)})),i=s.map((t=>t.length)).reduce(((t,e)=>t+e)),r=new Uint8Array(ft.length+n.length+i);r.set(n,ft.length);let o=ft.length+n.length;for(const t of s)r.set(t,o),o+=t.length;return r.set(ft),r}function vt(t,e,n){if(!t.subarray(0,3).every(((t,e)=>ft[e]===t)))throw new Error("Not a FlatGeobuf file");const s=new c(t),i=s.readUint32(ft.length);s.setPosition(ft.length+bt);const r=x(s);n&&n(r);let o=ft.length+bt+i;const{indexNodeSize:a,featuresCount:h}=r;a>0&&(o+=ct(h,a));const l=[];for(;o<s.capacity();){const t=s.readUint32(o);s.setPosition(o+bt);const n=C.getRootAsFeature(s);l.push(e(n,r)),o+=bt+t}return l}async function*wt(t,e,n){const s="function"==typeof(i=t).slice?i:new g("function"==typeof i.read?i:i.getReader());var i;const r=async t=>await s.slice(t);let o=new Uint8Array(await r(8));if(!o.subarray(0,3).every(((t,e)=>ft[e]===t)))throw new Error("Not a FlatGeobuf file");o=new Uint8Array(await r(4));let a=new c(o);const h=a.readUint32(0);o=new Uint8Array(await r(h)),a=new c(o);const l=x(a);n&&n(l);const{indexNodeSize:u,featuresCount:d}=l;if(u>0){const t=ct(d,u);await r(t)}let f;for(;f=await xt(r,l,e);)yield f}async function*Ct(t,e,n,s){const i=await gt.open(t);lt.debug("opened reader"),s&&s(i.header);for await(const t of i.selectBbox(e))yield n(t,i.header)}async function xt(t,e,n){let s=new Uint8Array(await t(4,"feature length"));if(0===s.byteLength)return;let i=new c(s);const r=i.readUint32(0);s=new Uint8Array(await t(r,"feature data"));const o=new Uint8Array(r+4);return o.set(s,4),i=new c(o),i.setPosition(bt),n(C.getRootAsFeature(i),e)}function It(t){const e=new d;let n=null;t.columns&&(n=v.createColumnsVector(e,t.columns.map((t=>function(t,e){const n=t.createString(e.name);return y.startColumn(t),y.addName(t,n),y.addType(t,e.type),y.endColumn(t)}(e,t)))));const s=e.createString("L1");v.startHeader(e),v.addFeaturesCount(e,BigInt(t.featuresCount)),v.addGeometryType(e,t.geometryType),v.addIndexNodeSize(e,0),n&&v.addColumns(e,n),v.addName(e,s);const i=v.endHeader(e);return e.finishSizePrefixed(i),e.asUint8Array()}function Ft(t){if("boolean"==typeof t)return p.Bool;if("number"==typeof t)return t%1==0?p.Int:p.Double;if("string"==typeof t)return p.String;if(null===t)return p.String;if("object"==typeof t)return p.Json;throw new Error(`Unknown type (value '${t}')`)}function Pt(t,e){return{name:e,type:Ft(t[e]),title:null,description:null,width:-1,precision:-1,scale:-1,nullable:!0,unique:!1,primary_key:!1}}function Et(t,e,n){return t instanceof Uint8Array?vt(t,e):t instanceof ReadableStream?wt(t,e):Ct(t,n,e)}const St=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Rt=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function Ut(t,e){return t>e?1:t<e?-1:0}function Tt(t,e){const n=Array.isArray(e)?e:[e],s=n.length;for(let e=0;e<s;e++)t[t.length]=n[e]}function At(){}function Ot(t){for(const e in t)delete t[e]}const Nt=class extends Rt{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),s=n[t]||(n[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e="string"==typeof t,n=e?t:t.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const i=e?new St(t):t;i.target||(i.target=this.eventTarget_||this);const r=this.dispatching_||(this.dispatching_={}),o=this.pendingRemovals_||(this.pendingRemovals_={});let a;n in r||(r[n]=0,o[n]=0),++r[n];for(let t=0,e=s.length;t<e;++t)if(a="handleEvent"in s[t]?s[t].handleEvent(i):s[t].call(this,i),!1===a||i.propagationStopped){a=!1;break}if(0==--r[n]){let t=o[n];for(delete o[n];t--;)this.removeEventListener(n,At);delete r[n]}return a}disposeInternal(){this.listeners_&&Ot(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){const n=this.listeners_&&this.listeners_[t];if(n){const s=n.indexOf(e);-1!==s&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[s]=At,++this.pendingRemovals_[t]):(n.splice(s,1),0===n.length&&delete this.listeners_[t]))}}},Mt="change";function Lt(t,e,n,s,i){if(s&&s!==t&&(n=n.bind(s)),i){const s=n;n=function(){t.removeEventListener(e,n),s.apply(this,arguments)}}const r={target:t,type:e,listener:n};return t.addEventListener(e,n),r}function Gt(t,e,n,s){return Lt(t,e,n,s,!0)}function Bt(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Ot(t))}class kt extends Nt{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Mt)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,s=new Array(n);for(let i=0;i<n;++i)s[i]=Lt(this,t[i],e);return s}return Lt(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const s=t.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=Gt(this,t[i],e)}else n=Gt(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Bt(t[e]);else Bt(t)}(n);else if(Array.isArray(t))for(let n=0,s=t.length;n<s;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}kt.prototype.on,kt.prototype.once,kt.prototype.un;const Vt=kt;function qt(){throw new Error("Unimplemented abstract method.")}let Dt=0;class Xt extends St{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}const jt=class extends Vt{constructor(t){super(),this.on,this.once,this.un,this.ol_uid||(this.ol_uid=String(++Dt)),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Xt(n,t,e)),n="propertychange",this.hasListener(n)&&this.dispatchEvent(new Xt(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const s=this.values_||(this.values_={});if(n)s[t]=e;else{const n=s[t];s[t]=e,n!==e&&this.notify(t,n)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],function(t){let e;for(e in t)return!1;return!e}(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},zt={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class Yt extends Error{constructor(t){const e=zt[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const $t=Yt;class Wt extends jt{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Wt(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Bt(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Lt(t,Mt,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(!function(t,e){if(!t)throw new $t(41)}("function"==typeof t.getZIndex),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Ht=Wt;new Array(6);const Zt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Kt(t,e,n){let s,i;return s=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,i=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,s*s+i*i}function Jt(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Qt(t,e){const n=t[0],s=t[1],i=t[2],r=t[3],o=e[0],a=e[1];let h=Zt.UNKNOWN;return o<n?h|=Zt.LEFT:o>i&&(h|=Zt.RIGHT),a<s?h|=Zt.BELOW:a>r&&(h|=Zt.ABOVE),h===Zt.UNKNOWN&&(h=Zt.INTERSECTING),h}function te(t,e,n,s,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=s,i):[t,e,n,s]}function ee(t){return te(1/0,1/0,-1/0,-1/0,t)}function ne(t,e,n,s,i){return se(ee(i),t,e,n,s)}function se(t,e,n,s,i){for(;n<s;n+=i)ie(t,e[n],e[n+1]);return t}function ie(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function re(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function oe(t){return t[3]-t[1]}const ae={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},he=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||ae[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},le=6378137,ue=Math.PI*le,ce=[-ue,-ue,ue,ue],de=[-180,-85,180,85],fe=le*Math.log(Math.tan(Math.PI/2));class be extends he{constructor(t){super({code:t,units:"m",extent:ce,global:!0,worldExtent:de,getPointResolution:function(t,e){return t/Math.cosh(e[1]/le)}})}}const ge=[new be("EPSG:3857"),new be("EPSG:102100"),new be("EPSG:102113"),new be("EPSG:900913"),new be("http://www.opengis.net/def/crs/EPSG/0/3857"),new be("http://www.opengis.net/gml/srs/epsg.xml#3857")];const pe=[-180,-90,180,90],_e=6378137*Math.PI/180;class ye extends he{constructor(t,e){super({code:t,units:"degrees",extent:pe,axisOrientation:e,global:!0,metersPerUnit:_e,worldExtent:pe})}}const me=[new ye("CRS:84"),new ye("EPSG:4326","neu"),new ye("urn:ogc:def:crs:OGC:1.3:CRS84"),new ye("urn:ogc:def:crs:OGC:2:84"),new ye("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ye("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ye("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ve={},we={};function Ce(t,e,n){const s=t.getCode(),i=e.getCode();s in we||(we[s]={}),we[s][i]=n}function xe(t,e){if(void 0!==e)for(let n=0,s=t.length;n<s;++n)e[n]=t[n];else e=t.slice();return e}function Ie(t,e){if(void 0!==e&&t!==e){for(let n=0,s=t.length;n<s;++n)e[n]=t[n];t=e}return t}function Fe(t){!function(t,e){ve[t]=e}(t.getCode(),t),Ce(t,t,xe)}function Pe(t){return"string"==typeof t?ve[e=t]||ve[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Ee(t){!function(t){t.forEach(Fe)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Ce(e,t,xe)}))}))}function Se(t,e){return function(t,e){let n=function(t,e){let n;return t in we&&e in we[t]&&(n=we[t][e]),n}(t.getCode(),e.getCode());return n||(n=Ie),n}(Pe(t),Pe(e))}var Re,Ue,Te;Ee(ge),Ee(me),Re=ge,Ue=function(t,e,n){const s=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(s));for(let i=0;i<s;i+=n){e[i]=ue*t[i]/180;let n=le*Math.log(Math.tan(Math.PI*(+t[i+1]+90)/360));n>fe?n=fe:n<-fe&&(n=-fe),e[i+1]=n}return e},Te=function(t,e,n){const s=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(s));for(let i=0;i<s;i+=n)e[i]=180*t[i]/ue,e[i+1]=360*Math.atan(Math.exp(t[i+1]/le))/Math.PI-90;return e},me.forEach((function(t){Re.forEach((function(e){Ce(t,e,Ue),Ce(e,t,Te)}))}));const Ae=[1,0,0,1,0,0],Oe=class extends jt{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=function(t){let e,n,s,i=!1;return function(){const r=Array.prototype.slice.call(arguments);return i&&this===s&&function(t,e){const n=t.length;if(n!==e.length)return!1;for(let s=0;s<n;s++)if(t[s]!==e[s])return!1;return!0}(r,n)||(i=!0,s=this,n=r,e=t.apply(this,arguments)),e}}((function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return qt()}closestPointXY(t,e,n,s){return qt()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return qt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&ee(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){qt()}scale(t,e,n){qt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return qt()}getType(){return qt()}applyTransform(t){qt()}intersectsExtent(t){return qt()}translate(t,e){qt()}transform(t,e){const n=Pe(t),s="tile-pixels"==n.getUnits()?function(t,s,i){const r=n.getExtent(),o=n.getWorldExtent(),a=oe(o)/oe(r);return function(t,e,n,s,i,r,o,a){const h=Math.sin(r),l=Math.cos(r);t[0]=s*l,t[1]=i*h,t[2]=-s*h,t[3]=i*l,t[4]=o*s*l-a*s*h+e,t[5]=o*i*h+a*i*l+n}(Ae,o[0],o[3],a,-a,0,0,0),function(t,e,n,s,i,r){r=r||[];let o=0;for(let e=0;e<n;e+=s){const n=t[e],s=t[e+1];r[o++]=i[0]*n+i[2]*s+i[4],r[o++]=i[1]*n+i[3]*s+i[5]}r&&r.length!=o&&(r.length=o)}(t,0,t.length,i,Ae,s),Se(n,e)(t,s,i)}:Se(n,e);return this.applyTransform(s),this}};function Ne(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Me=class extends Oe{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return qt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Ne(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){qt()}setLayout(t,e,n){let s;if(t)s=Ne(t);else{for(let t=0;t<n;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}s=e.length,t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();!function(t,e,n,s,i,r,o){o=o||[];const a=Math.cos(i),h=Math.sin(i),l=r[0],u=r[1];let c=0;for(let e=0;e<n;e+=s){const n=t[e]-l,i=t[e+1]-u;o[c++]=l+n*a-i*h,o[c++]=u+n*h+i*a;for(let n=e+2;n<e+s;++n)o[c++]=t[n]}o&&o.length!=c&&(o.length=c)}(n,0,n.length,s,t,e,n),this.changed()}}scale(t,e,n){void 0===e&&(e=t),n||(n=re(this.getExtent()));const s=this.getFlatCoordinates();if(s){const i=this.getStride();!function(t,e,n,s,i,r,o,a){a=a||[];const h=o[0],l=o[1];let u=0;for(let e=0;e<n;e+=s){const n=t[e]-h,o=t[e+1]-l;a[u++]=h+i*n,a[u++]=l+r*o;for(let n=e+2;n<e+s;++n)a[u++]=t[n]}a&&a.length!=u&&(a.length=u)}(s,0,s.length,i,t,e,n,s),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();!function(t,e,n,s,i,r,o){o=o||[];let a=0;for(let e=0;e<n;e+=s){o[a++]=t[e]+i,o[a++]=t[e+1]+r;for(let n=e+2;n<e+s;++n)o[a++]=t[n]}o&&o.length!=a&&(o.length=a)}(n,0,n.length,s,t,e,n),this.changed()}}};function Le(t,e,n,s){for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let n=0;n<s;++n)t[e++]=r[n]}return e}function Ge(t,e,n,s,i){i=i||[];let r=0;for(let o=0,a=n.length;o<a;++o){const a=Le(t,e,n[o],s);i[r++]=a,e=a}return i.length=r,i}function Be(t,e,n,s,i,r){const o=i-n,a=r-s;if(0!==o||0!==a){const h=((t-n)*o+(e-s)*a)/(o*o+a*a);h>1?(n=i,s=r):h>0&&(n+=o*h,s+=a*h)}return ke(t,e,n,s)}function ke(t,e,n,s){const i=n-t,r=s-e;return i*i+r*r}function Ve(t,e,n){return t+n*(e-t)}class qe extends Me{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new qe(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){const i=this.flatCoordinates,r=ke(t,e,i[0],i[1]);if(r<s){const t=this.stride;for(let e=0;e<t;++e)n[e]=i[e];return n.length=t,r}return s}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return function(t,e){const n=t[0],s=t[1];return te(n,s,n,s,e)}(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Jt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,s){for(let s=0,i=n.length;s<i;++s)t[e++]=n[s];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const De=qe;function Xe(t,e,n,s,i){i=void 0!==i?i:[];let r=0;for(let o=e;o<n;o+=s)i[r++]=t.slice(o,o+s);return i.length=r,i}function je(t,e,n,s,i){i=void 0!==i?i:[];let r=0;for(let o=0,a=n.length;o<a;++o){const a=n[o];i[r++]=Xe(t,e,a,s,i[r]),e=a}return i.length=r,i}class ze extends Me{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){this.flatCoordinates?Tt(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}clone(){const t=new ze(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){if(s<Kt(this.getExtent(),t,e))return s;const i=this.flatCoordinates,r=this.stride;for(let o=0,a=i.length;o<a;o+=r){const a=ke(t,e,i[o],i[o+1]);if(a<s){s=a;for(let t=0;t<r;++t)n[t]=i[o+t];n.length=r}}return s}getCoordinates(){return Xe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new De(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,s=[];for(let i=0,r=t.length;i<r;i+=n){const r=new De(t.slice(i,i+n),e);s.push(r)}return s}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let s=0,i=e.length;s<i;s+=n)if(Jt(t,e[s],e[s+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Le(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ye=ze;function $e(t,e,n,s,i,r,o){const a=t[e],h=t[e+1],l=t[n]-a,u=t[n+1]-h;let c;if(0===l&&0===u)c=e;else{const d=((i-a)*l+(r-h)*u)/(l*l+u*u);if(d>1)c=n;else{if(d>0){for(let i=0;i<s;++i)o[i]=Ve(t[e+i],t[n+i],d);return void(o.length=s)}c=e}}for(let e=0;e<s;++e)o[e]=t[c+e];o.length=s}function We(t,e,n,s,i){let r=t[e],o=t[e+1];for(e+=s;e<n;e+=s){const n=t[e],s=t[e+1],a=ke(r,o,n,s);a>i&&(i=a),r=n,o=s}return i}function He(t,e,n,s,i){for(let r=0,o=n.length;r<o;++r){const o=n[r];i=We(t,e,o,s,i),e=o}return i}function Ze(t,e,n,s,i,r,o,a,h,l,u){if(e==n)return l;let c,d;if(0===i){if(d=ke(o,a,t[e],t[e+1]),d<l){for(c=0;c<s;++c)h[c]=t[e+c];return h.length=s,d}return l}u=u||[NaN,NaN];let f=e+s;for(;f<n;)if($e(t,f-s,f,s,o,a,u),d=ke(o,a,u[0],u[1]),d<l){for(l=d,c=0;c<s;++c)h[c]=u[c];h.length=s,f+=s}else f+=s*Math.max((Math.sqrt(d)-Math.sqrt(l))/i|0,1);if(r&&($e(t,n-s,e,s,o,a,u),d=ke(o,a,u[0],u[1]),d<l)){for(l=d,c=0;c<s;++c)h[c]=u[c];h.length=s}return l}function Ke(t,e,n,s,i,r,o,a,h,l,u){u=u||[NaN,NaN];for(let c=0,d=n.length;c<d;++c){const d=n[c];l=Ze(t,e,d,s,i,r,o,a,h,l,u),e=d}return l}function Je(t,e,n,s,i,r,o){const a=(n-e)/s;if(a<3){for(;e<n;e+=s)r[o++]=t[e],r[o++]=t[e+1];return o}const h=new Array(a);h[0]=1,h[a-1]=1;const l=[e,n-s];let u=0;for(;l.length>0;){const n=l.pop(),r=l.pop();let o=0;const a=t[r],c=t[r+1],d=t[n],f=t[n+1];for(let e=r+s;e<n;e+=s){const n=Be(t[e],t[e+1],a,c,d,f);n>o&&(u=e,o=n)}o>i&&(h[(u-e)/s]=1,r+s<u&&l.push(r,u),u+s<n&&l.push(u,n))}for(let n=0;n<a;++n)h[n]&&(r[o++]=t[e+n*s],r[o++]=t[e+n*s+1]);return o}function Qe(t,e){return e*Math.round(t/e)}function tn(t,e,n,s,i,r,o){if(e==n)return o;let a,h,l=Qe(t[e],i),u=Qe(t[e+1],i);e+=s,r[o++]=l,r[o++]=u;do{if(a=Qe(t[e],i),h=Qe(t[e+1],i),(e+=s)==n)return r[o++]=a,r[o++]=h,o}while(a==l&&h==u);for(;e<n;){const n=Qe(t[e],i),c=Qe(t[e+1],i);if(e+=s,n==a&&c==h)continue;const d=a-l,f=h-u,b=n-l,g=c-u;d*g==f*b&&(d<0&&b<d||d==b||d>0&&b>d)&&(f<0&&g<f||f==g||f>0&&g>f)?(a=n,h=c):(r[o++]=a,r[o++]=h,l=a,u=h,a=n,h=c)}return r[o++]=a,r[o++]=h,o}function en(t,e,n,s,i,r,o,a){for(let h=0,l=n.length;h<l;++h){const l=n[h];o=tn(t,e,l,s,i,r,o),a.push(o),e=l}return o}function nn(t,e,n,s,i){let r;for(e+=s;e<n;e+=s)if(r=i(t.slice(e-s,e),t.slice(e,e+s)),r)return r;return!1}function sn(t,e,n,s,i,r,o){let a,h;const l=(n-e)/s;if(1===l)a=e;else if(2===l)a=e,h=i;else if(0!==l){let r=t[e],o=t[e+1],l=0;const u=[0];for(let i=e+s;i<n;i+=s){const e=t[i],n=t[i+1];l+=Math.sqrt((e-r)*(e-r)+(n-o)*(n-o)),u.push(l),r=e,o=n}const c=i*l,d=function(t,e,n){let s,i;n=n||Ut;let r=0,o=t.length,a=!1;for(;r<o;)s=r+(o-r>>1),i=+n(t[s],e),i<0?r=s+1:(o=s,a=!i);return a?r:~r}(u,c);d<0?(h=(c-u[-d-2])/(u[-d-1]-u[-d-2]),a=e+(-d-2)*s):a=e+d*s}o=o>1?o:2,r=r||new Array(o);for(let e=0;e<o;++e)r[e]=void 0===a?NaN:void 0===h?t[a+e]:Ve(t[a+e],t[a+s+e],h);return r}function rn(t,e,n,s,i,r){if(n==e)return null;let o;if(i<t[e+s-1])return r?(o=t.slice(e,e+s),o[s-1]=i,o):null;if(t[n-1]<i)return r?(o=t.slice(n-s,n),o[s-1]=i,o):null;if(i==t[e+s-1])return t.slice(e,e+s);let a=e/s,h=n/s;for(;a<h;){const e=a+h>>1;i<t[(e+1)*s-1]?h=e:a=e+1}const l=t[a*s-1];if(i==l)return t.slice((a-1)*s,(a-1)*s+s);const u=(i-l)/(t[(a+1)*s-1]-l);o=[];for(let e=0;e<s-1;++e)o.push(Ve(t[(a-1)*s+e],t[a*s+e],u));return o.push(i),o}function on(t,e,n,s,i){const r=function(t,e){let n;return n=e(function(t){return[t[0],t[1]]}(t)),n||(n=e(function(t){return[t[2],t[1]]}(t)),n||(n=e(function(t){return[t[2],t[3]]}(t)),n||(n=e(function(t){return[t[0],t[3]]}(t)),n||!1)))}(i,(function(i){return!an(t,e,n,s,i[0],i[1])}));return!r}function an(t,e,n,s,i,r){let o=0,a=t[n-s],h=t[n-s+1];for(;e<n;e+=s){const n=t[e],s=t[e+1];h<=r?s>r&&(n-a)*(r-h)-(i-a)*(s-h)>0&&o++:s<=r&&(n-a)*(r-h)-(i-a)*(s-h)<0&&o--,a=n,h=s}return 0!==o}function hn(t,e,n,s,i,r){if(0===n.length)return!1;if(!an(t,e,n[0],s,i,r))return!1;for(let e=1,o=n.length;e<o;++e)if(an(t,n[e-1],n[e],s,i,r))return!1;return!0}function ln(t,e,n,s,i){const r=se([1/0,1/0,-1/0,-1/0],t,e,n,s);return!!function(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}(i,r)&&(a=r,(o=i)[0]<=a[0]&&a[2]<=o[2]&&o[1]<=a[1]&&a[3]<=o[3]||r[0]>=i[0]&&r[2]<=i[2]||r[1]>=i[1]&&r[3]<=i[3]||nn(t,e,n,s,(function(t,e){return function(t,e,n){let s=!1;const i=Qt(t,e),r=Qt(t,n);if(i===Zt.INTERSECTING||r===Zt.INTERSECTING)s=!0;else{const o=t[0],a=t[1],h=t[2],l=t[3],u=e[0],c=e[1],d=n[0],f=n[1],b=(f-c)/(d-u);let g,p;r&Zt.ABOVE&&!(i&Zt.ABOVE)&&(g=d-(f-l)/b,s=g>=o&&g<=h),s||!(r&Zt.RIGHT)||i&Zt.RIGHT||(p=f-(d-h)*b,s=p>=a&&p<=l),s||!(r&Zt.BELOW)||i&Zt.BELOW||(g=d-(f-a)/b,s=g>=o&&g<=h),s||!(r&Zt.LEFT)||i&Zt.LEFT||(p=f-(d-o)*b,s=p>=a&&p<=l)}return s}(i,t,e)})));var o,a}function un(t,e,n,s,i){if(!function(t,e,n,s,i){return!!(ln(t,e,n,s,i)||an(t,e,n,s,i[0],i[1])||an(t,e,n,s,i[0],i[3])||an(t,e,n,s,i[2],i[1])||an(t,e,n,s,i[2],i[3]))}(t,e,n[0],s,i))return!1;if(1===n.length)return!0;for(let e=1,r=n.length;e<r;++e)if(on(t,n[e-1],n[e],s,i)&&!ln(t,n[e-1],n[e],s,i))return!1;return!0}class cn extends Me{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){this.flatCoordinates?Tt(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}clone(){const t=new cn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Kt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(We(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ze(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,s))}forEachSegment(t){return nn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Xe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return function(t,e,n,s){let i=t[e],r=t[e+1],o=0;for(let a=e+s;a<n;a+=s){const e=t[a],n=t[a+1];o+=Math.sqrt((e-i)*(e-i)+(n-r)*(n-r)),i=e,r=n}return o}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Je(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new cn(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return ln(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Le(this.flatCoordinates,0,t,this.stride),this.changed()}}const dn=cn;class fn extends Me{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{let e=this.getLayout();const n=t,s=[],i=[];for(let t=0,r=n.length;t<r;++t){const r=n[t];0===t&&(e=r.getLayout()),Tt(s,r.getFlatCoordinates()),i.push(s.length)}this.setFlatCoordinates(e,s),this.ends_=i}}appendLineString(t){this.flatCoordinates?Tt(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new fn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Kt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(He(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ke(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,s))}getCoordinateAtM(t,e,n){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,n=void 0!==n&&n,function(t,e,n,s,i,r,o){if(o)return rn(t,e,n[n.length-1],s,i,r);let a;if(i<t[s-1])return r?(a=t.slice(0,s),a[s-1]=i,a):null;if(t[t.length-1]<i)return r?(a=t.slice(t.length-s),a[s-1]=i,a):null;for(let r=0,o=n.length;r<o;++r){const o=n[r];if(e!=o){if(i<t[e+s-1])return null;if(i<=t[o-1])return rn(t,e,o,s,i,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return je(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new dn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,s=[];let i=0;for(let r=0,o=e.length;r<o;++r){const o=e[r],a=new dn(t.slice(i,o),n);s.push(a),i=o}return s}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const s=this.ends_,i=this.stride;for(let r=0,o=s.length;r<o;++r){const o=s[r];Tt(t,sn(e,n,o,i,.5)),n=o}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,s,i,r,o,a){for(let h=0,l=n.length;h<l;++h){const l=n[h];o=Je(t,e,l,s,i,r,o),a.push(o),e=l}return o}(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new fn(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,n,s,i){for(let r=0,o=n.length;r<o;++r){if(ln(t,e,n[r],s,i))return!0;e=n[r]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Ge(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const bn=fn;function gn(t,e,n,s){let i=0,r=t[n-s],o=t[n-s+1];for(;e<n;e+=s){const n=t[e],s=t[e+1];i+=o*n-r*s,r=n,o=s}return i/2}function pn(t,e,n,s){let i=0;for(let r=0,o=n.length;r<o;++r){const o=n[r];i+=gn(t,e,o,s),e=o}return i}class _n extends Me{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new _n(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,s){return s<Kt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(We(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ze(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,s))}getArea(){return gn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Xe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Je(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new _n(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Le(this.flatCoordinates,0,t,this.stride),this.changed()}}const yn=_n;function mn(t,e,n,s,i,r,o){let a,h,l,u,c,d,f;const b=i[r+1],g=[];for(let i=0,r=n.length;i<r;++i){const r=n[i];for(u=t[r-s],d=t[r-s+1],a=e;a<r;a+=s)c=t[a],f=t[a+1],(b<=d&&f<=b||d<=b&&b<=f)&&(l=(b-d)/(f-d)*(c-u)+u,g.push(l)),u=c,d=f}let p=NaN,_=-1/0;for(g.sort(Ut),u=g[0],a=1,h=g.length;a<h;++a){c=g[a];const i=Math.abs(c-u);i>_&&(l=(u+c)/2,hn(t,e,n,s,l,b)&&(p=l,_=i)),u=c}return isNaN(p)&&(p=i[r]),o?(o.push(p,b,_),o):[p,b,_]}function vn(t,e,n,s){for(;e<n-s;){for(let i=0;i<s;++i){const r=t[e+i];t[e+i]=t[n-s+i],t[n-s+i]=r}e+=s,n-=s}}function wn(t,e,n,s){let i=0,r=t[n-s],o=t[n-s+1];for(;e<n;e+=s){const n=t[e],s=t[e+1];i+=(n-r)*(s+o),r=n,o=s}return 0===i?void 0:i>0}function Cn(t,e,n,s,i){i=void 0!==i&&i;for(let r=0,o=n.length;r<o;++r){const o=n[r],a=wn(t,e,o,s);if(0===r){if(i&&a||!i&&!a)return!1}else if(i&&!a||!i&&a)return!1;e=o}return!0}function xn(t,e,n,s,i){i=void 0!==i&&i;for(let r=0,o=n.length;r<o;++r){const o=n[r],a=wn(t,e,o,s);(0===r?i&&a||!i&&!a:i&&!a||!i&&a)&&vn(t,e,o,s),e=o}return e}function In(t,e,n,s,i){for(let r=0,o=n.length;r<o;++r)e=xn(t,e,n[r],s,i);return e}class Fn extends Me{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Tt(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Fn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Kt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(He(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ke(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return hn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return pn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),xn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,je(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=re(this.getExtent());this.flatInteriorPoint_=mn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new De(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new yn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,s=[];let i=0;for(let r=0,o=n.length;r<o;++r){const o=n[r],a=new yn(e.slice(i,o),t);s.push(a),i=o}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Cn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=xn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=en(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new Fn(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return un(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Ge(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const Pn=Fn;class En extends Me{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){let s=this.getLayout();const i=t,r=[],o=[];for(let t=0,e=i.length;t<e;++t){const e=i[t];0===t&&(s=e.getLayout());const n=r.length,a=e.getEnds();for(let t=0,e=a.length;t<e;++t)a[t]+=n;Tt(r,e.getFlatCoordinates()),o.push(a)}e=s,t=r,n=o}void 0!==e&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const n=this.flatCoordinates.length;Tt(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,s=e.length;t<s;++t)e[t]+=n}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const n=new En(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,s){return s<Kt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,s,i){for(let r=0,o=n.length;r<o;++r){const o=n[r];i=He(t,e,o,s,i),e=o[o.length-1]}return i}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,s,i,r,o,a,h,l,u){u=u||[NaN,NaN];for(let r=0,c=n.length;r<c;++r){const c=n[r];l=Ke(t,e,c,s,i,true,o,a,h,l,u),e=c[c.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,n,s))}containsXY(t,e){return function(t,e,n,s,i,r){if(0===n.length)return!1;for(let o=0,a=n.length;o<a;++o){const a=n[o];if(hn(t,e,a,s,i,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,n,s){let i=0;for(let r=0,o=n.length;r<o;++r){const o=n[r];i+=pn(t,e,o,s),e=o[o.length-1]}return i}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),In(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,function(t,e,n,s,i){i=void 0!==i?i:[];let r=0;for(let o=0,a=n.length;o<a;++o){const a=n[o];i[r++]=1===a.length&&a[0]===e?[]:je(t,e,a,s,i[r]),e=a[a.length-1]}return i.length=r,i}(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=function(t,e,n,s){const i=[];let r=[1/0,1/0,-1/0,-1/0];for(let o=0,a=n.length;o<a;++o){const a=n[o];r=ne(t,e,a[0],s),i.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=a[a.length-1]}return i}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,n,s,i){let r=[];for(let o=0,a=n.length;o<a;++o){const a=n[o];r=mn(t,e,a,s,i,2*o,r),e=a[a.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Ye(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;!function(t,e,n,s,i){for(let i=0,r=n.length;i<r;++i){const r=n[i];if(!Cn(t,e,r,s,undefined))return!1;r.length&&(e=r[r.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=In(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,s,i,r,o,a){for(let h=0,l=n.length;h<l;++h){const l=n[h],u=[];o=en(t,e,l,s,i,r,o,u),a.push(u),e=l[l.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new En(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const n=this.endss_[t-1];e=n[n.length-1]}const n=this.endss_[t].slice(),s=n[n.length-1];if(0!==e)for(let t=0,s=n.length;t<s;++t)n[t]-=e;return new Pn(this.flatCoordinates.slice(e,s),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,s=[];let i=0;for(let r=0,o=n.length;r<o;++r){const o=n[r].slice(),a=o[o.length-1];if(0!==i)for(let t=0,e=o.length;t<e;++t)o[t]-=i;const h=new Pn(e.slice(i,a),t,o);s.push(h),i=a}return s}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,n,s,i){for(let r=0,o=n.length;r<o;++r){const o=n[r];if(un(t,e,o,s,i))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=function(t,e,n,s,i){i=i||[];let r=0;for(let o=0,a=n.length;o<a;++o){const a=Ge(t,e,n[o],s,i[r]);0===a.length&&(a[0]=e),i[r++]=a,e=a[a.length-1]}return i.length=r,i}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===n.length)this.flatCoordinates.length=0;else{const t=n[n.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const Sn=En;function Rn(t,e){let n;if(n=e===_.Unknown?t?.type():e,t){if(t.xyArray()){const e=Array.from(t.xyArray()),s=t.endsArray(),i=s?Array.from(s.map((t=>t<<1))):[e.length];switch(n){case _.Point:return new De(e);case _.MultiPoint:return new Ye(e,"XY");case _.LineString:return new dn(e,"XY");case _.MultiLineString:return new bn(e,"XY",i);case _.Polygon:return new Pn(e,"XY",i)}}else if(n===_.MultiPolygon){const e=new Sn([]);for(let n=0;n<t.partsLength();n++)e.appendPolygon(Rn(t.parts(n),_.Polygon));return e}throw new Error("Unknown type")}}function Un(t,e){const n=new Ht(t);return e&&n.setProperties&&n.setProperties(e),n}function Tn(t,e){return function(t,e,n,s){const i=e.columns;return s(n(t.geometry(),e.geometryType),A(t,i))}(t,e,Rn,Un)}function An(t){return mt(t)}function On(t,e,n){return t instanceof Uint8Array?function(t,e){return vt(t,Tn,e)}(t,n):t instanceof ReadableStream?function(t,e){return wt(t,Tn,e)}(t,n):function(t,e,n){return Ct(t,e,Tn,n)}(t,e,n)}function Nn(t){const e=t.coordinates,n=[],s=[];let i,r;const o=S(t.type);let a=0;switch(t.type){case"Point":case"MultiPoint":case"LineString":F(e,n,s);break;case"MultiLineString":case"Polygon":{const t=e;F(t,n,s),t.length>1&&(i=t.map((t=>a+=t.length)));break}case"MultiPolygon":{const t=e.map((t=>({type:"Polygon",coordinates:t})));r=t.map(Nn);break}}return{xy:n,z:s.length>0?s:void 0,ends:i,type:o,parts:r}}function Mn(t){const e=S(t.type),n=[];for(let e=0;e<t.geometries.length;e++){const s=t.geometries[e];"GeometryCollection"===s.type?n.push(Mn(s)):n.push(Nn(s))}return{type:e,parts:n}}function Ln(t,e){let n=e;if(n===_.Unknown&&(n=t.type()),n===_.GeometryCollection){const e=[];for(let n=0;n<t.partsLength();n++){const s=t.parts(n),i=s.type();e.push(Ln(s,i))}return{type:_[n],geometries:e}}if(n===_.MultiPolygon){const e=[];for(let n=0;n<t.partsLength();n++)e.push(Ln(t.parts(n),_.Polygon));return{type:_[n],coordinates:e.map((t=>t.coordinates))}}const s=function(t,e){const n=t.xyArray(),s=t.zArray();switch(e){case _.Point:{const t=Array.from(n);return s&&t.push(s[0]),t}case _.MultiPoint:case _.LineString:return E(n,s);case _.MultiLineString:case _.Polygon:return function(t,e,n){if(!n||0===n.length)return[E(t,e)];let s=0;const i=Array.from(n).map((e=>t.slice(s,s=e<<1)));let r;return e&&(s=0,r=Array.from(n).map((t=>e.slice(s,s=t)))),i.map(((t,e)=>E(t,r?r[e]:void 0)))}(n,s,t.endsArray())}}(t,n);return{type:_[n],coordinates:s}}function Gn(t,e){const n=e.columns;return{type:"Feature",geometry:Ln(t.geometry(),e.geometryType),properties:A(t,n)}}function Bn(t){const e=function(t){const e=t.features[0].properties;let n=null;e&&(n=Object.keys(e).map((t=>Pt(e,t))));return{geometryType:yt(t.features),columns:n,envelope:null,featuresCount:t.features.length,indexNodeSize:0,crs:null,title:null,description:null,metadata:null}}(t),n=It(e),s=t.features.map((t=>T("GeometryCollection"===t.geometry.type?Mn(t.geometry):Nn(t.geometry),t.properties,e))),i=s.map((t=>t.length)).reduce(((t,e)=>t+e)),r=new Uint8Array(ft.length+n.length+i);r.set(n,ft.length);let o=ft.length+n.length;for(const t of s)r.set(t,o),o+=t.length;return r.set(ft),r}function kn(t){return Bn(t)}function Vn(t,e,n){return t instanceof Uint8Array?function(t,e){return{type:"FeatureCollection",features:vt(t,Gn,e)}}(t,n):t instanceof ReadableStream?function(t,e){return wt(t,Gn,e)}(t,n):function(t,e,n){return Ct(t,e,Gn,n)}(t,e,n)}}}]);